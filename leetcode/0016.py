#!/usr/bin/python3

"""
16. 3Sum Closest
Difficulty: Medium

"""
from typing import List


class Solution:
    def threeSumClosest(self, nums: List[int], target: int) -> int:
        if (len(nums)) <= 3: return sum(nums)

        nums.sort()
        result_idx = []
        result_sum = nums[0] + nums[1] + nums[2]
        candidate_idx = [0, 1, 2]  # 0 = left_pointer 1 = mid_pointer 2 = right pointer
        candidate_sum = nums[0]
        gap = 62

        trigger = False
        if target >= 0:
            for i in range(len(nums)):
                if nums[i] >= target:
                    candidate_idx[1] = i - gap
                    trigger = True
                    break
            if not trigger: candidate_idx[1] = len(nums) - gap
        else:
            for i in range(len(nums) - 1, -1, -1):
                if nums[i] <= target:
                    candidate_idx[1] = i - gap
                    trigger = True
                    break
            if not trigger: candidate_idx[1] = 1

        if candidate_idx[1] < 1: candidate_idx[1] = 1

        steps_forward = gap
        while steps_forward > 0:
            if candidate_idx[1] >= len(nums): break
            candidate_idx[0] = candidate_idx[1]
            candidate_idx[2] = candidate_idx[1]
            for i in range(1, gap):
                for j in range(1, gap):
                    candidate_idx[0] = candidate_idx[1] - i
                    candidate_idx[2] = candidate_idx[1] + j
                    if candidate_idx[0] < 0: candidate_idx[0] = 0
                    if candidate_idx[2] >= len(nums): candidate_idx[2] = len(nums) - 1
                    if (candidate_idx[0] != candidate_idx[1]) and (candidate_idx[0] != candidate_idx[2]) and (
                            candidate_idx[1] != candidate_idx[2]):
                        candidate_sum = nums[candidate_idx[0]] + nums[candidate_idx[1]] + nums[candidate_idx[2]]
                        if abs(candidate_sum - target) < abs(result_sum - target):
                            result_sum = candidate_sum
                            result_idx = candidate_idx[:]
            candidate_idx[1] += 1

            steps_forward -= 1

        return result_sum


sol = Solution()
print(sol.threeSumClosest(
    nums=[84, -17, 32, -89, 55, 79, 27, -60, 36, -51, 39, -89, -77, 97, 38, -72, 6, -49, -74, 44, -24, 95, -33, -13,
          -75, -25, 8, -61, 87, 49, -71, 12, 76, -81, -65, 79, -81, 39, 25, -49, 48, 45, -54, 74, -95, 64, -42, -7,
          -3, 68, -46, -56, -17, 5, -13, 74, -95, 84, 56, -88, -79, 82, -60, -5, 43, -29, 51, -81, 47, 42, -6, -54,
          100, 48, 61, 71, 19, -27, 7, 40, -37, 72, 20, 88, -4, 60, 10, 44, -17, 30, -60, -18, 19, -90, -9, -42,
          -65, -100, 32, 85, -82, 80, 23, 0, 49, -19, 97, -54, 14, 7, 5, -35, -29, -20, -53, 30, 14, -92, 66, 45,
          54, 90, 33, -99, 18, -2, 21, 25, 3, 78, -16, -56, 84, 1, 4, -30, 76, -40, -28, 88, 44, 2, -59, -82, 73,
          50, -67, -53, -85, 32, 66, 79, -47, -82, 57, 87, -91, 98], target=-216))

if sol.threeSumClosest(nums=[1, 1, 1, 1], target=0) != 3: print('err-1')
if sol.threeSumClosest(nums=[-1, 2, 1, -4], target=1) != 2: print('err-2')
if sol.threeSumClosest(nums=[1, 2, 4, 8, 16, 32, 64, 128], target=82) != 82: print('err-3')
if sol.threeSumClosest(nums=[0, 2, 1, -3], target=1) != 0: print('err-4')
if sol.threeSumClosest(nums=[0, 5, -1, -2, 4, -1, 0, -3, 4, -5], target=1) != 1: print('err-5')
if sol.threeSumClosest(nums=[-10, 0, -2, 3, -8, 1, -10, 8, -8, 6, -7, 0, -7, 2, 2, -5, -8, 1, -4, 6],
                       target=18) != 17: print('err-6')
if sol.threeSumClosest(
        nums=[0, -16, -11, -4, 6, 20, -17, 10, 14, -11, -16, 17, -14, -11, 8, -4, 0, -2, 10, 15, 0, -2, -3, 19, 17, -18,
              8,
              -16, -4, -16, -20, 16, -16, 5, -3, -18, -12, -18, -9, 11, 3, -14, -18, 8, 11, -9, -1, 6, 1, -17, -9, -7,
              11,
              -10, 18, -1, 4, -8, 1, -20, -19, -19, 12, 13, 14, 15, 0, 18, 3, 8, -4, 18, -1, 6, -19, -11, 11, 14, 12,
              11,
              -15, 2, 4, -1, 5, 3, -17, 15, -1, -15, 3, 16, -11, -14, 14, 4, -7, -20, -2, -14, -8, -12, -12, 18, 4, -12,
              16], target=-31) != -31: print('err-7')

if sol.threeSumClosest(
        nums=
        [-94, -92, 31, 60, -31, -5, 0, -48, -30, 96, -93, 47, 56, -45, -77, -56, -10, 43, 63, 90, -100, 65, -80, 94, 98,
         65, -56, -45, -87, 78, 47, 99, 47, -64, 77, -70, 81, 76, 80, 36, 23, -99, -79, -91, 66, 95, -1, -1, 33, 24,
         -51, -86, 95, -58, -96, 84, 61, 97, -58, -37, 22, -68, 24, -4, -67, -67, 88, 82, -79, 56, -100, 58, -54, -32,
         -74, -68, 67, 18, -71, -48, 83, -21, -99, 51, -8, -16, 12, 34, -60, -44, -35, -62, 14, -59, -34, 89, -53, 53,
         -78, 94, 77, -61, -49, 20, -27, 8, 76, -96, -16, -6, 93, -33, -36, -62, -22, -67, -30, 19, 54, -20, -36, -8,
         -31, -67, 24, 31, 0, 28, 16, 17, -11, -69, -43, -53, 93, 44, -34, 73, -89, 45, -46, 63, 6, -49, 47, 93, 82, 33,
         -14, -20, 25, -1, -48, -56, 47, -49, 43, 4, -68, 37, 86, -6, -56, 91, -24, -43, 40, 40, -51, -58, -64, -56, 84,
         -22, -81, 32, 55, 32, 43, -13, -100, -15, 66, 61, 85, -81, 57, 20, 64, -57, -68, 8, -60, 65, 97, 3, 33, -68,
         40, 83, -79, 38, 32, -41, 67, -72, -54, 22, 54, -49], target=121) != 121: print('err-7')

if sol.threeSumClosest(
        nums=
        [-49, -84, 68, -30, 30, -77, -15, -39, -98, -78, -96, 13, 10, 14, -55, 48, -13, -61, 81, -77, 9, 85, -88, -86,
         -96, 49, 4, -34, 83, 67, 85, -7, 12, 10, 92, 71, 5, 57, -11, -10, -72, 65, -54, 58, 79, -6, -5, -93, 14, 44,
         56, -72, 35, -87, 4, -20, 89, -85, 15, -45, 33, 89, 31, -89, 15, -17, -12, 31, -17, 61, 47, -29, 98, -10, 22,
         38, 73, 60, -39, 82, -47, -58, -21, 73, -72, 25, -46, 88, 34, 54, -19, -78, -84, -94, -18, -9, -7, -56, 88, 99,
         61, -10, -43, -83, 62, -67, 95, -4, -14, 100, 5, 29, 7, 73, -46, 20, 60, 81, 95, -13, -32, 69, 56, -4, -2, 68,
         79, -53, -14, 81, -63, 100, -97, -59, -9, 12, 84, 0, 19, 76, 8, 63, -39, -38, -7, 45, -51, -60, 91, 4, 22, -74,
         -64, 77, 45, 38, -95, -72, 82, -52, -27, 26, -74, -92, -70, 97, 13, -96, -77, -26, 57, 6, 30, 50, -19, 68],
        target=30) != 30: print('err-8')

if sol.threeSumClosest(
        nums=
        [-71, -82, -14, -64, -23, -33, -77, 93, 27, 36, -19, 94, -65, 65, -58, -68, -2, 29, 60, 20, 59, -49, 91, 31, 98,
         -28, -12, -14, -49, 55, -70, 0, -3, -21, 54, 12, 94, -81, -35, 33, 11, 15, 15, 34, -40, 36, -43, -48, -98, 76,
         42, 30, -14, 85, 56, -82, 11, -23, 92, 56, -11, 41, 60, 67, 23, -75, 96, 0, -14, -25, -70, -70, 70, -74, -16,
         -94, -20, -48, 56, -70, -55, -10, 47, 92, -63, 98, 91, -45, 26, 88, 47, 35, -48, 79, -96, -48, 24, -32, -36,
         -100, -7, -63, -64, 23, -59, 98, 92, -38, -48, -8, 31, 60, 82, 93, -15, 82, -89, 86, 50, -74, 20, -46, 35, 50,
         -67, -26, 81, 18, -43, -45, -69, -13, 2, 41, -75, 94, -17, -38, -90, 35, 79, -19, 79, 54, -82, -47, -58, -74,
         -25, -45, -96, -26, 45, -31, 85, -57, 26, 89, -46, 94, 6, -78, -66, -91], target=-250) != -250: print('err-9')

if sol.threeSumClosest(
        nums=
        [14, 55, 33, 92, 35, 7, -87, -11, -54, 13, -18, -92, -32, 94, 100, 32, 15, -83, -6, -25, 2, 29, 50, 5, 81, 41,
         -42, 93, 58, -43, 62, -2, -28, 25, -91, -77, -15, -47, 12, -1, -37, 59, 41, -86, -69, -88, 36, 7, 7, 65, -14,
         -57, 80, -27, -56, 51, 71, -70, -26, 42, -16, 92, -51, -15, 63, 22, -54, 39, 48, 91, -60, -28, 17, -74, 20, 71,
         -10, 88, 93, 86, -48, -65, -52, 34, 68, 70, -100, 91, 63, 59, -12, -51, 24, 50, 6, 71, 9, -56, 71, 28, 48, 32,
         62, -96, 18, 39, -17, -19, -61, -91, -71, 89, 63, -75, 67, -38, 66, -60, -24, 85, -43, 5, 47, -67, -60, 7, -18,
         77, 73, 47, 19, 53, 54, 80, -34, -54, -20, -2, -50, 7, -26, 5, -43, -91, 100, -87, 56, 71, -52, 54, 46, -29,
         33, 66, -67, -58, -54, -2, 78, -78, -98, -29, 3, 62, 82, -73, 90, -26, 100],
        target=-235) != -235: print('err-10')

if sol.threeSumClosest(
        nums=
        [4, -8, 98, -51, 73, 12, -31, 39, 87, -16, 20, 69, 18, 59, 54, 44, -58, 40, -36, 22, -60, -8, -43, 83, 88, 1,
         -25, 71, -53, 33, 60, 32, 61, -5, 28, 38, -28, 45, 25, -68, -60, -87, 5, -94, -19, -31, -35, -29, 0, 24, -62,
         -84, -7, -94, -89, 12, 97, -32, -89, 92, -50, -54, -18, 12, 84, -81, -99, 67, 24, -4, -88, 61, 48, -17, -17,
         -44, 65, -18, -47, 68, 0, -7, 78, 36, 0, -15, 23, -4, 1, -74, -64, -53, -82, -10, 34, -57, -93, 65, -3, -73,
         -8, -59, 96, 35, 51, 49, 92, -8, -4, -100, -64, 5, -86, -26, 71, 60, -85, -42, -13, -10, 17, -11, 59, -14, -5,
         34, -36, 24, 9, 78, 48, 24, -88, -46, -76, 31, -47, -68, 29, 34, -97, -69, -41, -87, -42, 96, 0, -90, 51, -55,
         57, 86, -61, 41, 1, -90, -9, 63, 84, -32, 80, -15, -12, 0, 72, -22, -6, -64, 94, 23, -80, -25, -37, -38, 69,
         12, -64, -95, -65, 5, 15, -31, -68, -55, -100, -89, -24, -66, 33, -14, -40, -50, -19, -79, -4],
        target=-76) != -76: print('err-11')

if sol.threeSumClosest(
        nums=[13, 34, 8, 91, 0, -47, 52, 23, 76, 14, 0, -9, 22, 49, -1, 68, 49, -83, -34, 5, 38, 3, 47, -2, -73, -29,
              19, -4, -3, -16, 89, 52, 18, 27, 40, 88, -84, -68, 84, 53, 52, 28, -86, -80, 18, -93, 11, 77, 11, -83, 69,
              -29, -26, -83, 32, 65, -49, -88, -24, -56, 95, -82, -25, -69, -27, 20, -87, -49, 78, 89, 100, 26, 45, -15,
              47, 77, 86, 46, 82, -80, -31, 72, -82, -63, -50, 35, -36, -30, -40, 82, 83, -61, -49, -11, 88, 73, -23, 2,
              63, 29, -82, 95, -91, 31, -35, -84, 37, -86, -17, -84, -54, -89, 32, 13, -21, 73, -73, 53, -57, -60, 62,
              -43, 54, 52, 91, -7, 23, -53, 53, -82, -75, 43, 21, 76, 45, -2, -46, -39, -39, -3, 24, 6, -73, 34, 58,
              -67, 35, 45, -72, -67, -57, -22, -81, 68, -84, -15, 14, -87, 14, -45, -68, 4, -88, -25, -36, -74, -27, 27,
              -23, 26, -99, -47, 97, 32, 53, 82, -89, 91, -1, -67, -74, -97, -36, 7, -51, -100, -74, 28, -12, -46, -37,
              87, 80, -33, -58, 51, 5], target=-61) != -61: print('err-12')

if sol.threeSumClosest(
        nums=[84, -17, 32, -89, 55, 79, 27, -60, 36, -51, 39, -89, -77, 97, 38, -72, 6, -49, -74, 44, -24, 95, -33, -13,
              -75, -25, 8, -61, 87, 49, -71, 12, 76, -81, -65, 79, -81, 39, 25, -49, 48, 45, -54, 74, -95, 64, -42, -7,
              -3, 68, -46, -56, -17, 5, -13, 74, -95, 84, 56, -88, -79, 82, -60, -5, 43, -29, 51, -81, 47, 42, -6, -54,
              100, 48, 61, 71, 19, -27, 7, 40, -37, 72, 20, 88, -4, 60, 10, 44, -17, 30, -60, -18, 19, -90, -9, -42,
              -65, -100, 32, 85, -82, 80, 23, 0, 49, -19, 97, -54, 14, 7, 5, -35, -29, -20, -53, 30, 14, -92, 66, 45,
              54, 90, 33, -99, 18, -2, 21, 25, 3, 78, -16, -56, 84, 1, 4, -30, 76, -40, -28, 88, 44, 2, -59, -82, 73,
              50, -67, -53, -85, 32, 66, 79, -47, -82, 57, 87, -91, 98], target=-216) != -216: print('err-13')

if sol.threeSumClosest(
        nums=
        [85, 17, 99, 58, 76, -80, 68, -38, -74, -75, -88, -31, 17, -2, -40, -57, 29, -84, -16, -31, -80, -39, 58, -33,
         67, 11, 38, 2, -31, -48, -29, 28, -11, -52, 86, -86, 59, 45, 68, 15, -17, 56, 34, 8, 29, 69, -93, 84, -76, -98,
         85, 59, 40, -93, -47, -9, 100, 51, 55, 31, -47, -9, -63, -9, -94, 32, 21, 88, 60, 36, -54, 2, 42, 86, -44, -81,
         -82, -29, -48, 49, 77, -19, 3, 26, -53, 35, 39, 92, -56, 77, -59, 56, -13, 18, -56, -70, 81, 31, -28, -13, -51,
         19, 86, 36, 20, 7, -2, -52, -14, -10, -70, 3, -34, 100, 90, 75, -27, -62, -37, -19, 42, 68, -56, -94, 22, -6,
         49, -74, 76, -11, -18, -71, -46, 23, 62, -72, 35, 82, 92, 27, -10, -38, -9, 7, -18, -83, -37, 48, -18, 98, -80,
         16, 6, -72, -4, 45, -99, 39, 27, -24, 31, -48, 26, 16, 32, -56, -14, 94, -36, 86, 30, -21, 45, -68, -74, 50,
         -65, 39, -25, 67, 1, -36, 61, -2, 60, 71, -16], target=67) != 67: print('err-14')
